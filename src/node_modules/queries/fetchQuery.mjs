import fetch from 'node-fetch';

const VIRTUOSO_ENDPOINT = 'http://ec2-18-170-45-162.eu-west-2.compute.amazonaws.com:8890/sparql'

const endpoints = {
    'virtuoso': VIRTUOSO_ENDPOINT
}

export const querySparql = async (endpoint, query, options) => {

    if (endpoint in endpoints)
        endpoint = endpoints[endpoint];

    let url = new URL(endpoint)
    url.searchParams.append('query', query);
    for (const [key, value] of Object.entries(options)) {
        url.searchParams.append(key, value);
    }

    let res = await fetch(url);
    if (res.ok) {
        return res.text();
    }
    throw new Error(`Couldn't fetch query\n\n${query}\n\n had error ${res.status}`)
}